/*!
 * ~
 *  maishu-chitu-service v1.11.0
 *  https://github.com/ansiboy/services-sdk
 *  
 *  Copyright (c) 2016-2018, shu mai <ansiboy@163.com>
 *  Licensed under the MIT License.
 * 
 */!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.funcs=new Array}add(e){this.funcs.push(e)}remove(e){this.funcs=this.funcs.filter(t=>t!=e)}fire(...e){this.funcs.forEach(t=>t(...e))}}t.Callback=n,t.Callbacks=function(){return new n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{argumentNull(e){let t=new Error(`Argument ${e} cannt be null or emtpy.`);return t.name=n.prototype.argumentNull.name,t}routeDataFieldNull(e){let t=new Error(`The ${e} field of route data cannt be null.`);return t.name=n.prototype.routeDataFieldNull.name,t}argumentFieldNull(e,t){let r=new Error(`The ${e} field of ${t} cannt be null.`);return r.name=n.prototype.argumentFieldNull.name,r}}t.Errors=n,t.errors={serviceUrlCanntNull:e=>new Error(`Service '${e}' base url can not null.`),unexpectedNullResult:()=>new Error("Null result is unexpected."),unexpectedNullValue:e=>new Error(`variable ${e} is unexpected null value.`),argumentNull:e=>new Error(`Arugment ${e} cannt null or empty.`),fieldNull:(e,t)=>new Error(`${t} ${e} cannt be null or empty`),instanceMessangerStart:()=>new Error("Instance messanger is start.")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3);t.Service=n.Service;var o=r(0);t.Callback=o.Callback,t.Callbacks=o.Callbacks;var a=r(4);t.ValueStore=a.ValueStore,t.LocalValueStore=a.LocalValueStore,t.CookieValueStore=a.CookieValueStore;var s=r(5);t.guid=s.guid;var u=r(1);t.Errors=u.Errors},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,a){function s(e){try{i(n.next(e))}catch(e){a(e)}}function u(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,u)}i((n=n.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const callback_1=__webpack_require__(0),errors_1=__webpack_require__(1);class Service{constructor(e){this.error=callback_1.Callbacks(),e&&this.error.add((t,r)=>{e(r,this)})}ajax(e,t){void 0===t&&(t={});let r,n=t.data,o=t.method,a=t.headers||{};if(null!=n){if((a["content-type"]||"").indexOf("json")>=0)r=JSON.stringify(n);else{r=new URLSearchParams;for(let e in n)r.append(e,n[e])}}return new Promise((t,n)=>{let s,u={headers:a,body:r,method:o};if(null==u)throw errors_1.errors.unexpectedNullValue("options");"get"==o&&(s=setTimeout(()=>{console.warn(`timeout url: ${e}`);let t=new Error;t.name="timeout",t.message="网络连接超时",n(t),this.error.fire(this,t),clearTimeout(s)},1e3*Service.settings.ajaxTimeout)),ajax(e,u).then(e=>{t(e),s&&clearTimeout(s)}).catch(e=>{n(e),this.error.fire(this,e),s&&clearTimeout(s)})})}createService(e){let t=new(e=e||Service);return t.error.add((e,r)=>{this.error.fire(t,r)}),t}getByJson(e,t){t&&Object.getOwnPropertyNames(t).length>0&&(e=`${e}?${encodeURIComponent(JSON.stringify(t))}`);return this.ajax(e,{headers:{"content-type":"application/json"},method:"get"})}putByJson(e,t){return this.ajax(e,{headers:{"content-type":"application/json"},data:t,method:"put"})}postByJson(e,t){return this.ajax(e,{headers:{"content-type":"application/json"},data:t,method:"post"})}deleteByJson(e,t){return this.ajax(e,{headers:{"content-type":"application/json"},data:t,method:"delete"})}isEncoded(e){try{return(e=e||"")!==decodeURIComponent(e)}catch(e){return!1}}get(e,t){t=t||{};let r="";for(let e in t){if(null==t[e])continue;let n=`${t[e]}`;this.isEncoded(n)||(n=encodeURIComponent(n)),r=r?`${r}&${e}=${n}`:`${e}=${n}`}return r&&(e=`${e}?${r}`),this.ajax(e,{method:"get"})}put(e,t){return this.ajax(e,{headers:{"content-type":"application/x-www-form-urlencoded"},data:t,method:"put"})}post(e,t){return this.ajax(e,{headers:{"content-type":"application/x-www-form-urlencoded"},data:t,method:"post"})}delete(e,t){return this.ajax(e,{headers:{"content-type":"application/x-www-form-urlencoded"},data:t,method:"delete"})}}function ajax(url,options){return __awaiter(this,void 0,void 0,function*(){let response;response="undefined"==typeof window?yield eval("require")("node-fetch")(url,options):yield fetch(url,options);let responseText=response.text(),p;p="string"==typeof responseText?new Promise((e,t)=>{e(responseText)}):responseText;let text=yield responseText,textObject,isJSONContextType=(response.headers.get("content-type")||"").indexOf("json")>=0;if(textObject=isJSONContextType?text?JSON.parse(text):{}:text,response.status>=300){let e=new Error;throw e.method=options.method,e.name=`${response.status}`,e.message=isJSONContextType?textObject.Message||textObject.message||"":textObject,e.message=e.message||response.statusText,e}return textObject})}exports.Service=Service,Service.settings={ajaxTimeout:30},Service.isClass=function(){var e=Function.prototype.toString;return function(t){return"function"==typeof t&&(/^class(\s|\{\}$)/.test(e.call(t))||/^.*classCallCheck\(/.test(function(t){return e.call(t).replace(/^[^{]*{\s*/,"").replace(/\s*}[^}]*$/,"")}(t)))}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.items=new Array,this._value=e}attach(e,t){return void 0!==this.value&&e(this.value,t),this.add(e,t)}add(e,t){return this.items.push({func:e,sender:t}),e}remove(e){this.items=this.items.filter(t=>t.func!=e)}fire(e){this.items.forEach(t=>t.func(e,t.sender))}get value(){return void 0===this._value?null:this._value}set value(e){this._value=e,this.fire(e)}}t.ValueStore=n;class o extends n{constructor(e){super(o.loadValue(e)),this.storageName=e}get value(){return super.value}set value(e){super.value=e,o.saveValue(this.storageName,e)}static loadValue(e){let t=localStorage.getItem(e);return null==t?null:JSON.parse(t)}static saveValue(e,t){null!=t?localStorage.setItem(e,JSON.stringify(t)):localStorage.removeItem(e)}}t.LocalValueStore=o;class a extends n{constructor(e){super(a.loadValue(e)),this.storageName=e}get value(){return super.value}set value(e){super.value=e,a.saveValue(this.storageName,e)}static loadValue(e){let t=a.getCookie(e);return null==t?null:JSON.parse(t)}static saveValue(e,t){null!=t?a.setCookie(e,JSON.stringify(t)):a.removeCookie(e)}static setCookie(e,t,r){if("undefined"!=typeof document){var n="";if(r){var o=new Date;o.setTime(o.getTime()+24*r*60*60*1e3),n="; expires="+o.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/"}}static getCookie(e){if("undefined"==typeof document)return null;for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}static removeCookie(e){this.setCookie(e,"")}}t.CookieValueStore=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}]);
//# sourceMappingURL=index.min.js.map